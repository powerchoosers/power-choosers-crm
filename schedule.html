<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Schedule Free Energy Consultation | Get Commercial Electricity Quote</title>
  <meta name="description"
    content="Schedule a free consultation with our energy experts. Get competitive commercial electricity rates quote for your business. No obligation. Serving Texas, PJM, MISO markets.">
  <link rel="canonical" href="https://powerchoosers.com/schedule.html">
  <link rel="icon" type="image/png" sizes="32x32"
    href="https://cdn.prod.website-files.com/6801ddaf27d1495f8a02fd3f/68645bd391ea20fecb011c85_2656%20Webclip%20PChoosers.png">
  <!-- Breadcrumb Structured Data -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://powerchoosers.com"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Schedule",
          "item": "https://powerchoosers.com/schedule.html"
        }
      ]
    }
    </script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <!-- Shared Public Styles -->
  <link rel="stylesheet" href="styles/public.css">

  <style>
    /* Page-specific styles */

    /* Page Header */
    .page-header {
      background: linear-gradient(135deg, #0b1b45 0%, #1e3a8a 100%);
      color: #ffffff;
      padding: 80px 24px 60px;
      text-align: center;
      position: relative;
      overflow: hidden
    }

    .page-header::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(600px at 50% 50%, rgba(245, 158, 11, .1), transparent);
      pointer-events: none
    }

    .page-header h1 {
      font-size: 48px;
      font-weight: 800;
      margin-bottom: 16px;
      line-height: 1.1;
      position: relative;
      z-index: 1
    }

    .page-header p {
      font-size: 20px;
      opacity: .9;
      max-width: 700px;
      margin: 0 auto;
      position: relative;
      z-index: 1
    }

    @media (max-width: 768px) {
      .page-header {
        padding: 60px 16px 40px
      }

      .page-header h1 {
        font-size: 32px
      }

      .page-header p {
        font-size: 16px
      }
    }

    /* Booking Container */
    .booking-container {
      max-width: 900px;
      margin: 0 auto;
      padding: 60px 24px;
      width: 100%
    }

    .booking-card {
      background: linear-gradient(135deg, #ffffff 0%, #fafbfc 100%);
      border: 1px solid rgba(229, 231, 235, .6);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-lg);
      padding: 48px;
      position: relative;
      overflow: hidden
    }

    .booking-card::before {
      content: "";
      position: absolute;
      top: 0;
      right: 0;
      width: 400px;
      height: 400px;
      background: radial-gradient(circle, rgba(245, 158, 11, .05), transparent);
      border-radius: 50%;
      pointer-events: none
    }

    .form-section {
      margin-bottom: 32px
    }

    .form-section:last-child {
      margin-bottom: 0
    }

    .form-section-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 20px;
      color: var(--brand-blue);
      display: flex;
      align-items: center;
      gap: 12px
    }

    .form-section-title::before {
      content: "";
      width: 4px;
      height: 24px;
      background: linear-gradient(180deg, var(--brand-orange), #d97706);
      border-radius: 2px
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px
    }

    .form-group {
      display: flex;
      flex-direction: column
    }

    .form-group.full {
      grid-column: 1/-1
    }

    .form-group label {
      font-weight: 600;
      color: var(--text);
      margin-bottom: 8px;
      font-size: 14px
    }

    .form-group label .required {
      color: var(--brand-orange);
      margin-left: 4px
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px 16px;
      background: #ffffff;
      color: var(--text);
      border: 2px solid var(--border);
      border-radius: 10px;
      font-size: 15px;
      transition: var(--transition);
      font-family: inherit
    }

    .form-group input:hover,
    .form-group select:hover,
    .form-group textarea:hover {
      border-color: #9ca3af;
      background: #fafbfc
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: var(--brand-orange);
      background: #ffffff;
      box-shadow: 0 0 0 3px rgba(245, 158, 11, .1);
      transform: translateY(-1px)
    }

    .form-group textarea {
      resize: vertical;
      min-height: 120px;
      line-height: 1.6
    }

    .form-group .help-text {
      font-size: 12px;
      color: var(--muted);
      margin-top: 6px
    }

    .time-slots {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 12px;
      margin-top: 16px
    }

    .time-slot {
      padding: 14px 16px;
      background: #ffffff;
      border: 2px solid var(--border);
      border-radius: 10px;
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
      font-weight: 600;
      color: var(--text)
    }

    .time-slot:hover {
      border-color: var(--brand-orange);
      background: rgba(245, 158, 11, .05);
      transform: translateY(-2px)
    }

    .time-slot.selected {
      background: linear-gradient(135deg, var(--brand-orange) 0%, #d97706 100%);
      border-color: var(--brand-orange);
      color: #ffffff;
      box-shadow: 0 4px 12px rgba(245, 158, 11, .3)
    }

    .time-slot.disabled {
      opacity: .4;
      cursor: not-allowed;
      background: #f1f5f9
    }

    .submit-section {
      display: flex;
      justify-content: flex-end;
      gap: 16px;
      margin-top: 40px;
      padding-top: 32px;
      border-top: 1px solid var(--border)
    }

    .success-message {
      display: none;
      background: linear-gradient(135deg, rgba(34, 197, 94, .1) 0%, rgba(34, 197, 94, .05) 100%);
      border: 2px solid rgba(34, 197, 94, .3);
      border-radius: var(--radius-lg);
      padding: 24px;
      margin-top: 24px;
      text-align: center
    }

    .success-message.show {
      display: block
    }

    .success-message h3 {
      color: #16a34a;
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 8px
    }

    .success-message p {
      color: var(--muted);
      line-height: 1.6
    }

    .error-message {
      display: none;
      background: linear-gradient(135deg, rgba(220, 38, 38, .1) 0%, rgba(220, 38, 38, .05) 100%);
      border: 2px solid rgba(220, 38, 38, .3);
      border-radius: var(--radius-lg);
      padding: 16px;
      margin-top: 16px;
      color: #dc2626;
      font-size: 14px
    }

    .error-message.show {
      display: block
    }

    .loading-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, .5);
      backdrop-filter: blur(4px);
      z-index: 1000;
      align-items: center;
      justify-content: center
    }

    .loading-overlay.show {
      display: flex
    }

    .loading-spinner {
      width: 48px;
      height: 48px;
      border: 4px solid rgba(255, 255, 255, .3);
      border-top-color: #ffffff;
      border-radius: 50%;
      animation: spin .8s linear infinite
    }

    @keyframes spin {
      to {
        transform: rotate(360deg)
      }
    }

    @media (max-width: 768px) {
      .booking-container {
        padding: 40px 16px
      }

      .booking-card {
        padding: 32px 24px
      }

      .form-grid {
        grid-template-columns: 1fr
      }

      .time-slots {
        grid-template-columns: repeat(2, 1fr)
      }

      .submit-section {
        flex-direction: column-reverse
      }

      .submit-section .btn {
        width: 100%
      }
    }

    /* Footer */
    .footer {
      background: linear-gradient(180deg, #f8fafc, #ffffff);
      border-top: 1px solid var(--border);
      padding: 48px 24px;
      margin-top: 80px
    }

    .footer-content {
      max-width: var(--container);
      margin: 0 auto;
      text-align: center;
      color: var(--muted);
      font-size: 14px
    }

    .footer-content a {
      color: var(--muted);
      transition: color .2s
    }

    .footer-content a:hover {
      color: var(--brand-orange);
      text-decoration: none
    }
  </style>
  <style>
    /* Animations */
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-on-scroll {
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.8s cubic-bezier(0.2, 0.8, 0.2, 1), transform 0.8s cubic-bezier(0.2, 0.8, 0.2, 1);
      will-change: opacity, transform;
    }

    .animate-on-scroll.visible {
      opacity: 1;
      transform: translateY(0);
    }
  </style>
  <!-- Apollo Tracking Script -->
  <script>function initApollo() { var n = Math.random().toString(36).substring(7), o = document.createElement("script"); o.src = "https://assets.apollo.io/micro/website-tracker/tracker.iife.js?nocache=" + n, o.async = !0, o.defer = !0, o.onload = function () { window.trackingFunctions.onLoad({ appId: "691c89270f724f000d121b65" }) }, document.head.appendChild(o) } initApollo();</script>
</head>

<body>
  <header class="site-header">
    <nav class="nav">
      <a href="/" class="brand">
        <img
          src="https://cdn.prod.website-files.com/6801ddaf27d1495f8a02fd3f/68645bd391ea20fecb011c85_2656%20Webclip%20PChoosers.png"
          alt="Power Choosers" />
        <span class="brand-name">Power Choosers</span>
      </a>
      <button class="menu-toggle" id="nav-toggle" aria-label="Open menu">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="3" y1="6" x2="21" y2="6" />
          <line x1="3" y1="12" x2="21" y2="12" />
          <line x1="3" y1="18" x2="21" y2="18" />
        </svg>
      </button>
      <div class="nav-links">
        <a href="/" class="btn btn-outline">Home</a>
        <a href="/#services" class="btn btn-outline">Services</a>
        <a href="/about" class="btn btn-outline">About</a>
        <a href="/resources" class="btn btn-outline">Resources</a>
        <a href="/#get-started" class="btn btn-primary">Contact</a>
      </div>
    </nav>
  </header>

  <div class="page-header">
    <h1>Schedule Your Consultation</h1>
    <p>Book a free consultation with our energy experts. We'll help you find the best energy solutions for your
      business.</p>
  </div>

  <div class="booking-container">
    <div class="booking-card">
      <form id="booking-form">
        <div class="form-section">
          <div class="form-section-title">Your Information</div>
          <div class="form-grid">
            <div class="form-group">
              <label>Contact Name <span class="required">*</span></label>
              <input type="text" id="contact-name" name="contactName" required placeholder="John Smith">
            </div>
            <div class="form-group">
              <label>Company Name <span class="required">*</span></label>
              <input type="text" id="company-name" name="companyName" required placeholder="Acme Inc.">
            </div>
            <div class="form-group">
              <label>Email Address <span class="required">*</span></label>
              <input type="email" id="email" name="email" required placeholder="john@company.com">
            </div>
            <div class="form-group">
              <label>Work Direct Phone <span class="required">*</span></label>
              <input type="tel" id="phone" name="phone" required placeholder="+1 (817) 809-3367">
              <div class="help-text">Format: +1 (XXX) XXX-XXXX</div>
            </div>
          </div>
        </div>

        <div class="form-section">
          <div class="form-section-title">Select Date & Time</div>
          <div class="form-group">
            <label>Preferred Date <span class="required">*</span></label>
            <input type="date" id="appointment-date" name="appointmentDate" required min="">
            <div class="help-text">Select a date for your consultation</div>
          </div>
          <div class="form-group">
            <label>Preferred Time <span class="required">*</span></label>
            <div class="time-slots" id="time-slots">
              <div class="time-slot" data-time="09:00 AM">9:00 AM</div>
              <div class="time-slot" data-time="10:00 AM">10:00 AM</div>
              <div class="time-slot" data-time="11:00 AM">11:00 AM</div>
              <div class="time-slot" data-time="12:00 PM">12:00 PM</div>
              <div class="time-slot" data-time="01:00 PM">1:00 PM</div>
              <div class="time-slot" data-time="02:00 PM">2:00 PM</div>
              <div class="time-slot" data-time="03:00 PM">3:00 PM</div>
              <div class="time-slot" data-time="04:00 PM">4:00 PM</div>
            </div>
            <input type="hidden" id="selected-time" name="selectedTime" required>
          </div>
        </div>

        <div class="form-section">
          <div class="form-section-title">Additional Information</div>
          <div class="form-group full">
            <label>What would you like to discuss?</label>
            <textarea id="additional-notes" name="additionalNotes"
              placeholder="Tell us about your energy needs, current situation, or any specific questions you have..."></textarea>
            <div class="help-text">Optional: Help us prepare for our conversation</div>
          </div>
        </div>

        <div class="error-message" id="error-message"></div>
        <div class="success-message" id="success-message">
          <h3>✓ Consultation Scheduled!</h3>
          <p>Thank you for scheduling a consultation. We'll send you a confirmation email shortly and one of our energy
            experts will reach out to confirm the details.</p>
        </div>

        <div class="submit-section">
          <button type="button" class="btn btn-outline" onclick="window.location.href='/'">Cancel</button>
          <button type="submit" class="btn btn-primary" id="submit-btn">Schedule Consultation</button>
        </div>
      </form>
    </div>
  </div>

  <div class="loading-overlay" id="loading-overlay">
    <div class="loading-spinner"></div>
  </div>

  <footer class="footer">
    <div class="footer-content">
      © <span id="y"></span> Power Choosers. All rights reserved.
    </div>
  </footer>

  <!-- Firebase SDK (Compat) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="scripts/firebase.js"></script>
  <script>
    // Phone number normalization (matching contact-detail.js format)
    function normalizePhone(input) {
      const raw = (input || '').toString().trim();
      if (!raw) return '';

      // Remove all non-digit characters except + and extension markers
      const cleaned = raw.replace(/[^\d+ext.#]/gi, '');

      // Parse extension if present
      let number = raw;
      let extension = '';
      const extPatterns = [
        /ext\.?\s*(\d+)/i,
        /extension\s*(\d+)/i,
        /x\.?\s*(\d+)/i,
        /#\s*(\d+)/i,
        /\s+(\d{3,6})\s*$/
      ];

      for (const pattern of extPatterns) {
        const match = number.match(pattern);
        if (match) {
          extension = match[1];
          number = number.replace(pattern, '').trim();
          break;
        }
      }

      // Format the number part
      const digits = number.replace(/\D/g, '');
      let formattedNumber = '';

      if (digits.length === 11 && digits.startsWith('1')) {
        formattedNumber = `+1 (${digits.slice(1, 4)}) ${digits.slice(4, 7)}-${digits.slice(7)}`;
      } else if (digits.length === 10) {
        formattedNumber = `+1 (${digits.slice(0, 3)}) ${digits.slice(3, 6)}-${digits.slice(6)}`;
      } else if (/^\+/.test(String(number))) {
        formattedNumber = number;
      } else if (digits.length >= 8) {
        formattedNumber = '+' + digits;
      } else {
        return raw;
      }

      // Add extension if present
      if (extension) {
        return `${formattedNumber} ext. ${extension}`;
      }

      return formattedNumber;
    }

    // Set minimum date to today
    const dateInput = document.getElementById('appointment-date');
    if (dateInput) {
      const today = new Date().toISOString().split('T')[0];
      dateInput.setAttribute('min', today);
    }

    // Time slot selection
    const timeSlots = document.querySelectorAll('.time-slot');
    const selectedTimeInput = document.getElementById('selected-time');
    let selectedTime = '';

    timeSlots.forEach(slot => {
      slot.addEventListener('click', () => {
        if (slot.classList.contains('disabled')) return;
        timeSlots.forEach(s => s.classList.remove('selected'));
        slot.classList.add('selected');
        selectedTime = slot.getAttribute('data-time');
        if (selectedTimeInput) selectedTimeInput.value = selectedTime;
      });
    });

    // Form submission
    const form = document.getElementById('booking-form');
    const loadingOverlay = document.getElementById('loading-overlay');
    const errorMessage = document.getElementById('error-message');
    const successMessage = document.getElementById('success-message');
    const submitBtn = document.getElementById('submit-btn');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      // Validate time selection
      if (!selectedTime) {
        showError('Please select a time slot');
        return;
      }

      const formData = new FormData(form);
      const rawDate = formData.get('appointmentDate');
      // Convert YYYY-MM-DD to MM/DD/YYYY format for tasks.js compatibility
      let formattedDate = rawDate;
      if (rawDate && rawDate.includes('-')) {
        const [year, month, day] = rawDate.split('-');
        formattedDate = `${month}/${day}/${year}`;
      }

      const rawPhone = formData.get('phone');
      const normalizedPhone = normalizePhone(rawPhone);

      const bookingData = {
        contactName: formData.get('contactName'),
        companyName: formData.get('companyName'),
        email: formData.get('email'),
        phone: normalizedPhone,
        appointmentDate: formattedDate,
        selectedTime: selectedTime,
        additionalNotes: formData.get('additionalNotes') || ''
      };

      // Validate
      if (!bookingData.contactName || !bookingData.companyName || !bookingData.email || !bookingData.phone || !bookingData.appointmentDate) {
        showError('Please fill in all required fields');
        return;
      }

      showLoading(true);
      hideError();
      hideSuccess();

      // Call secure API endpoint (uses Firebase Admin SDK)
      try {
        const API_BASE_URL = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1'
          ? 'http://localhost:3000'
          : 'https://power-choosers-crm-792458658491.us-south1.run.app';

        const response = await fetch(`${API_BASE_URL}/api/create-booking`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            ...bookingData,
            source: 'schedule'
          })
        });

        const result = await response.json();

        if (!response.ok) {
          throw new Error(result.error || 'Failed to create booking');
        }

        // Show success
        showSuccess();
        form.reset();
        timeSlots.forEach(s => s.classList.remove('selected'));
        selectedTime = '';
        if (selectedTimeInput) selectedTimeInput.value = '';

        // Dispatch event for notification system on crm-dashboard
        window.dispatchEvent(new CustomEvent('pc:booking-created', {
          detail: {
            contactName: bookingData.contactName,
            companyName: bookingData.companyName,
            appointmentDate: bookingData.appointmentDate,
            selectedTime: bookingData.selectedTime,
            source: 'schedule',
            taskId: result.taskId || 'new'
          }
        }));

        // Also add notification directly if Notifications system is available
        if (window.Notifications && typeof window.Notifications.add === 'function') {
          const message = `${bookingData.contactName} from ${bookingData.companyName} scheduled a consultation${bookingData.appointmentDate ? ` for ${bookingData.appointmentDate}` : ''}${bookingData.selectedTime ? ` at ${bookingData.selectedTime}` : ''}`;
          window.Notifications.add('new-lead', 'New Consultation Scheduled', message, {
            contactName: bookingData.contactName,
            companyName: bookingData.companyName,
            appointmentDate: bookingData.appointmentDate,
            selectedTime: bookingData.selectedTime,
            source: 'schedule'
          });
        }

        // Dispatch event for tasks.js to refresh
        window.dispatchEvent(new CustomEvent('tasksUpdated', { detail: { source: 'booking' } }));

      } catch (error) {
        console.error('Booking error:', error);
        showError('There was an error scheduling your consultation. Please try again or contact us directly.');
      } finally {
        showLoading(false);
      }
    });


    function showLoading(show) {
      if (loadingOverlay) {
        if (show) loadingOverlay.classList.add('show');
        else loadingOverlay.classList.remove('show');
      }
      if (submitBtn) submitBtn.disabled = show;
    }

    function showError(message) {
      if (errorMessage) {
        errorMessage.textContent = message;
        errorMessage.classList.add('show');
        successMessage.classList.remove('show');
      }
    }

    function hideError() {
      if (errorMessage) errorMessage.classList.remove('show');
    }

    function showSuccess() {
      if (successMessage) {
        successMessage.classList.add('show');
        errorMessage.classList.remove('show');
        // Scroll to success message
        successMessage.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }
    }

    function hideSuccess() {
      if (successMessage) successMessage.classList.remove('show');
    }

    // Initialize scroll animations for page-specific elements
    document.addEventListener('DOMContentLoaded', () => {
      const elements = document.querySelectorAll('.page-header > *, .booking-card');
      elements.forEach(el => el.classList.add('animate-on-scroll'));
    });
  </script>

  <!-- Shared Public Scripts -->
  <script src="scripts/public.js"></script>

  // Year
  document.getElementById('y').textContent = new Date().getFullYear();
  </script>
</body>

</html>